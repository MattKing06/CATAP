# REMEMBER you need  "key  : value" the __space__ either side of : is required !!! 
controls_information:
    PV: true
    pv_record_map:
        # THESE SET THE MASK AND ROI TOGTHER AND SHOULD BE USED, 
        # (BUT ACTUALLY THER IS A BUG MAYBE IN STEVE KINDER'S CODE, A WORKAROUND REQUIRES THEM TO MOVE INDEPENDENT
        # NO _RBV versions of these PVs 
        ROIandMask_SetX    : EBT-INJ-DIA-CAM-05:ANA:SetX
        ROIandMask_SetY    : EBT-INJ-DIA-CAM-05:ANA:SetY
        ROIandMask_SetXrad : EBT-INJ-DIA-CAM-05:ANA:SetXRad
        ROIandMask_SetYrad : EBT-INJ-DIA-CAM-05:ANA:SetYRad 
        # the "mask" from JW/TP implementation 
        ANA_MaskXCenter     : EBT-INJ-DIA-CAM-05:ANA:MaskXCenter
        ANA_MaskYCenter     : EBT-INJ-DIA-CAM-05:ANA:MaskYCenter
        ANA_MaskXRad        : EBT-INJ-DIA-CAM-05:ANA:MaskXRad
        ANA_MaskYRad        : EBT-INJ-DIA-CAM-05:ANA:MaskYRad
        ANA_MaskYRad_RBV    : EBT-INJ-DIA-CAM-05:ANA:MaskYRad_RBV
        ANA_MaskXRad_RBV    : EBT-INJ-DIA-CAM-05:ANA:MaskXRad_RBV
        ANA_MaskWidth_RBV   : EBT-INJ-DIA-CAM-05:ANA:MaskWidth_RBV
        ANA_MaskHeight_RBV  : EBT-INJ-DIA-CAM-05:ANA:MaskHeight_RBV
        ANA_MaskYCenter_RBV : EBT-INJ-DIA-CAM-05:ANA:MaskYCenter_RBV
        ANA_MaskXCenter_RBV : EBT-INJ-DIA-CAM-05:ANA:MaskXCenter_RBV
        # ROI SK implementation  
        ROI1_MinX      : EBT-INJ-DIA-CAM-05:ROI1:MinX
        ROI1_MinY      : EBT-INJ-DIA-CAM-05:ROI1:MinY
        ROI1_SizeX     : EBT-INJ-DIA-CAM-05:ROI1:SizeX
        ROI1_SizeY     : EBT-INJ-DIA-CAM-05:ROI1:SizeY
        ROI1_MinY_RBV  : EBT-INJ-DIA-CAM-05:ROI1:MinY_RBV
        ROI1_MinX_RBV  : EBT-INJ-DIA-CAM-05:ROI1:MinX_RBV
        ROI1_SizeY_RBV : EBT-INJ-DIA-CAM-05:ROI1:SizeY_RBV
        ROI1_SizeX_RBV : EBT-INJ-DIA-CAM-05:ROI1:SizeX_RBV
        ROI1_ImageData_RBV  : EBT-INJ-DIA-CAM-05:CAM3:ArrayData
        # central co-ord definition 
        ANA_CenterX     : EBT-INJ-DIA-CAM-05:ANA:CenterX
        ANA_CenterY     : EBT-INJ-DIA-CAM-05:ANA:CenterY
        ANA_CenterX_RBV : EBT-INJ-DIA-CAM-05:ANA:CenterX_RBV
        ANA_CenterY_RBV : EBT-INJ-DIA-CAM-05:ANA:CenterY_RBV
        # start stop acquiring images 
        CAM_Acquire_RBV   : EBT-INJ-DIA-CAM-05:CAM:Acquire_RBV
        CAM_Active_Count  : EBT-B03-IOC-CS-05:cameraCount
        CAM_Active_Limit  : EBT-B03-IOC-CS-05:cameraLimit
        CAM_Stop_Acquire  : EBT-INJ-DIA-CAM-05:CAM:Stop
        CAM_Start_Acquire : EBT-INJ-DIA-CAM-05:CAM:Start
        # #  analysis, enable callbacks is start / stop analysis 
        ANA_EnableCallbacks     : EBT-INJ-DIA-CAM-05:ANA:EnableCallbacks
        ANA_EnableCallbacks_RBV : EBT-INJ-DIA-CAM-05:ANA:EnableCallbacks_RBV
        # analysis overlays  (TO BE BENCHMARKED AND CROSS CHECKED SUSPECT INVERTED Y AXIS) 
        ANA_OVERLAY_3_MASK       : EBT-INJ-DIA-CAM-05:OVER:3:Use
        ANA_OVERLAY_1_CROSS      : EBT-INJ-DIA-CAM-05:OVER:1:Use
        ANA_OVERLAY_2_RESULT     : EBT-INJ-DIA-CAM-05:OVER:2:Use
        ANA_OVERLAY_3_MASK_RBV   : EBT-INJ-DIA-CAM-05:OVER:3:Use_RBV
        ANA_OVERLAY_1_CROSS_RBV  : EBT-INJ-DIA-CAM-05:OVER:1:Use_RBV
        ANA_OVERLAY_2_RESULT_RBV : EBT-INJ-DIA-CAM-05:OVER:2:Use_RBV
        # the analysis can use a back ground subtracted image 
        ANA_NewBkgrnd     : EBT-INJ-DIA-CAM-05:ANA:NewBkgrnd
        ANA_UseBkgrnd     : EBT-INJ-DIA-CAM-05:ANA:UseBkgrnd
        ANA_UseBkgrnd_RBV : EBT-INJ-DIA-CAM-05:ANA:UseBkgrnd_RBV
        ANA_NewBkgrnd_RBV : EBT-INJ-DIA-CAM-05:ANA:NewBkgrnd_RBV
        # The analysis can set a noise floor, pixel values below this are set to zero 
        ANA_UseFloor           : EBT-INJ-DIA-CAM-05:ANA:UseFloor
        ANA_FloorLevel         : EBT-INJ-DIA-CAM-05:ANA:Floor
        ANA_UseFloor_RBV       : EBT-INJ-DIA-CAM-05:ANA:UseFloor_RBV
        ANA_FloorLevel_RBV     : EBT-INJ-DIA-CAM-05:ANA:Floor_RBV
        ANA_FlooredPoints_RBV  : EBT-INJ-DIA-CAM-05:ANA:FLOORED_PTS
        ANA_FlooredPercent_RBV : EBT-INJ-DIA-CAM-05:ANA:FLOORED_PCENT
        # Analysis CPU metrics 
        ANA_CPU_RBV             : EBT-INJ-DIA-CAM-05:ANA:ANA_CPU
        ANA_CPU_Dot_RBV         : EBT-INJ-DIA-CAM-05:ANA:DP_CPU
        ANA_CPU_Npoint_RBV      : EBT-INJ-DIA-CAM-05:ANA:NP_CPU
        ANA_CPU_CropSubMask_RBV : EBT-INJ-DIA-CAM-05:ANA:CSM_CPU
        # pixel conversions 
        ANA_PixMM     : EBT-INJ-DIA-CAM-05:ANA:PixMM
        ANA_PixW_RBV  : EBT-INJ-DIA-CAM-05:ANA:PixW_RBV
        ANA_PixH_RBV  : EBT-INJ-DIA-CAM-05:ANA:PixH_RBV
        ANA_PixMM_RBV : EBT-INJ-DIA-CAM-05:ANA:PixMM_RBV
        # the analysis can use "n-point scaling" see image analysis notes written by DJS / Tim Price / Matt Toplis 
        ANA_UseNPoint          : EBT-INJ-DIA-CAM-05:ANA:UseNPoint   
        ANA_UseNPoint_RBV      : EBT-INJ-DIA-CAM-05:ANA:UseNPoint_RBV   
        ANA_NPointStepSize     : EBT-INJ-DIA-CAM-05:ANA:StepSize
        ANA_NPointStepSize_RBV : EBT-INJ-DIA-CAM-05:ANA:StepSize_RBV
        # ANALYIS RESULTS
        ANA_X_RBV            : EBT-INJ-DIA-CAM-05:ANA:X_RBV
        ANA_Y_RBV            : EBT-INJ-DIA-CAM-05:ANA:Y_RBV
        ANA_XPix_RBV         : EBT-INJ-DIA-CAM-05:ANA:XPix_RBV
        ANA_YPix_RBV         : EBT-INJ-DIA-CAM-05:ANA:YPix_RBV
        ANA_CovXY_RBV        : EBT-INJ-DIA-CAM-05:ANA:CovXY_RBV
        ANA_SigmaY_RBV       : EBT-INJ-DIA-CAM-05:ANA:SigmaY_RBV
        ANA_SigmaX_RBV       : EBT-INJ-DIA-CAM-05:ANA:SigmaX_RBV
        ANA_CovXYPix_RBV     : EBT-INJ-DIA-CAM-05:ANA:CovXYPix_RBV
        ANA_SigmaYPix_RBV    : EBT-INJ-DIA-CAM-05:ANA:SigmaYPix_RBV
        ANA_SigmaXPix_RBV    : EBT-INJ-DIA-CAM-05:ANA:SigmaXPix_RBV
        ANA_Intensity_RBV    : EBT-INJ-DIA-CAM-05:ANA:Intensity_RBV
        ANA_MMResults_RBV    : EBT-INJ-DIA-CAM-05:ANA:MMResults_RBV 
        ANA_PixelResults_RBV : EBT-INJ-DIA-CAM-05:ANA:PixelResults_RBV 
        ANA_AvgIntensity_RBV : EBT-INJ-DIA-CAM-05:ANA:AvgIntensity_RBV
        # # actual array data
        CAM1_ArrayData : EBT-INJ-DIA-CAM-05:CAM1:ArrayData
        CAM2_ArrayData : EBT-INJ-DIA-CAM-05:CAM2:ArrayData
        # CAM3_ArrayData    : EBT-INJ-DIA-CAM-05:CAM3:ArrayData
        # image buffer dumping
        HDFB_Buffer_FileNumber         : EBT-INJ-DIA-CAM-05:HDFB:FileNumber
        HDFB_image_buffer_trigger      : EBT-INJ-DIA-CAM-05:CAM:Trigger.PROC
        HDFB_Buffer_FileNumber_RBV     : EBT-INJ-DIA-CAM-05:HDFB:FileNumber_RBV
        HDFB_image_buffer_filePath     : EBT-INJ-DIA-CAM-05:HDFB:FilePath
        HDFB_image_buffer_fileName     : EBT-INJ-DIA-CAM-05:HDFB:FileName
        HDFB_image_buffer_fileName_RBV : EBT-INJ-DIA-CAM-05:HDFB:FileName_RBV
        HDFB_image_buffer_filePath_RBV : EBT-INJ-DIA-CAM-05:HDFB:FilePath_RBV
        # cam array rate and temperature 
        CAM_ArrayRate_RBV     : EBT-INJ-DIA-CAM-05:CAM:ArrayRate_RBV
        CAM_Temperature_RBV   : EBT-INJ-DIA-CAM-05:CAM:Temperature_RBV
        CAM_AcquireTime_RBV   : EBT-INJ-DIA-CAM-05:CAM:AcquireTime_RBV
        CAM_AcquirePeriod_RBV : EBT-INJ-DIA-CAM-05:CAM:AcquirePeriod_RBV
        # image capture
        HDF_Capture        : EBT-INJ-DIA-CAM-05:HDF:Capture
        HDF_FilePath       : EBT-INJ-DIA-CAM-05:HDF:FilePath
        HDF_FileName       : EBT-INJ-DIA-CAM-05:HDF:FileName
        HDF_WriteFile      : EBT-INJ-DIA-CAM-05:HDF:WriteFile
        HDF_FileNumber     : EBT-INJ-DIA-CAM-05:HDF:FileNumber
        HDF_NumCapture     : EBT-INJ-DIA-CAM-05:HDF:NumCapture
        HDF_WriteStatus    : EBT-INJ-DIA-CAM-05:HDF:WriteStatus
        HDF_Capture_RBV    : EBT-INJ-DIA-CAM-05:HDF:Capture_RBV
        HDF_WriteMessage   : EBT-INJ-DIA-CAM-05:HDF:WriteMessage
        HDF_FilePath_RBV   : EBT-INJ-DIA-CAM-05:HDF:FilePath_RBV
        HDF_FileName_RBV   : EBT-INJ-DIA-CAM-05:HDF:FileName_RBV
        HDF_WriteFile_RBV  : EBT-INJ-DIA-CAM-05:HDF:WriteFile_RBV # TODO add to all cams
        HDF_FileNumber_RBV : EBT-INJ-DIA-CAM-05:HDF:FileNumber_RBV
        HDF_NumCapture_RBV : EBT-INJ-DIA-CAM-05:HDF:NumCapture_RBV
        # MAGICK_FileName    : EBT-INJ-DIA-CAM-05:MAGICK:FileName
        # MAGICK_FilePath    : EBT-INJ-DIA-CAM-05:MAGICK:FilePath
        # MAGICK_FileNumber    : EBT-INJ-DIA-CAM-05:MAGICK:FileNumber
        # MAGICK_Capture    : EBT-INJ-DIA-CAM-05:MAGICK:Capture
        # MAGICK_WriteFile    : EBT-INJ-DIA-CAM-05:MAGICK:WriteFile
        # MAGICK_NumCapture    : EBT-INJ-DIA-CAM-05:MAGICK:NumCapture
        # MAGICK_NumCaptured_RBV    : EBT-INJ-DIA-CAM-05:MAGICK:NumCaptured_RBV
        # MAGICK_WriteFile_RBV    : EBT-INJ-DIA-CAM-05:MAGICK:WriteFile_RBV
        # MAGICK_WriteStatus    : EBT-INJ-DIA-CAM-05:MAGICK:WriteStatus
        # MAGICK_WriteMessage    : EBT-INJ-DIA-CAM-05:MAGICK:WriteMessage
        # MAGICK_Capture_RBV    : EBT-INJ-DIA-CAM-05:MAGICK:Capture_RBV
        # MAGICK_NumCapture_RBV    : EBT-INJ-DIA-CAM-05:MAGICK:NumCapture_RBV
        # LEDs, also go in their own factory 
        LED_Sta : EBT-INJ-DIA-LED-01:Sta
        LED_Off : EBT-INJ-DIA-LED-01:Off
        LED_On  : EBT-INJ-DIA-LED-01:On
        CAM_Gain :           EBT-INJ-DIA-CAM-05:CAM:GainRaw
        CAM_Gain_RBV :       EBT-INJ-DIA-CAM-05:CAM:GainRaw_RBV
        CAM_BlackLevel :     EBT-INJ-DIA-CAM-05:CAM:BlackLevelRaw
        CAM_BlackLevel_RBV : EBT-INJ-DIA-CAM-05:CAM:BlackLevelRaw_RBV
properties:
    hardware_type: Camera
    machine_area : INJ # Set by where the camera physically *IS* 
    name : EBT-INJ-DIA-CAM-05
    name_alias: INJ-CAM-05, INJ-CAM5  # include screen names here as well 
    CAM_TYPE : VELA_CAM 
    SCREEN_NAME : INJ-SCR-04,INJ-YAG-04,INJ-SCR-4,INJ-YAG-4 # which screen is the camera looking at 
    IP_ADDRESS_STREAM : "" 
    MAX_SHOTS_NUMBER  :	600 # max number of shots that can be taken in a single burst 
    ## these are the indices of each value in the array PixelResults_RBV
    RESULTS_COUNT : 5 #
    X_POS : 0 #
    Y_POS : 1 #
    X_SIGMA_POS : 2 #
    Y_SIGMA_POS : 3 #
    COV_POS : 4 #
    ## these are the names of each value in the array PixelResults_RBV to be keys for a python dictionary
    X_NAME : X
    Y_NAME : Y
    X_SIGMA_NAME : X_SIGMA
    Y_SIGMA_NAME : Y_SIGMA
    COV_NAME : COV
    X_MASK_DEF				: 1392 #; some default values, better values  are to be determined
    Y_MASK_DEF				: 1040 #; some default values, better values  are to be determined
    X_MASK_RAD_DEF			: 1240 #some default values, better values  are to be determined
    Y_MASK_RAD_DEF			: 1040 #some default values, better values  are to be determined
    X_MASK_RAD_MAX			: 300 ##max value of mask radius 
    Y_MASK_RAD_MAX			: 300 #max value of mask radius
    USE_MASK_RAD_LIMITS : TRUE #; shoudl use mask max values
    ARRAY_DATA_NUM_PIX_X : 1392 #; array data passed through EPICS
    ARRAY_DATA_NUM_PIX_Y : 1040 #; array data passed through EPICS
    BINARY_NUM_PIX_X : 1392 #; the binary image is bigger than the array data passed through EPICS
    BINARY_NUM_PIX_Y : 1040 #; the binary image is bigger than the array data passed through EPICS
    X_PIX_SCALE_FACTOR : 1 #; scaling from array_data num pixels to binary image data num pixels
    Y_PIX_SCALE_FACTOR : 1 #; 
    AVG_PIXEL_VALUE_FOR_BEAM : 97.2 #;  emprically determined value for when laser is present
    X_CENTER_DEF      : 0 #;    where is (0,0) ? TBD
    Y_CENTER_DEF      : 0 #;
    PIX_2_MM_RATIO_DEF : 0.006 #; !!! from wiki 
    ARRAY_DATA_X_PIX_2_MM : 0.006 #; 
    ARRAY_DATA_Y_PIX_2_MM :  0.006 #;
    SENSOR_MAX_TEMP : 27.0 #;
    SENSOR_MIN_TEMP : 5.0 #;
    MIN_X_PIXEL_POS : 150.0 #; these are used to decide if the beam is close to the edge    float  as analysis results in pixels returns float  
    MAX_X_PIXEL_POS : 2400.0 #; these are used to decide if the beam is close to the edge
    MIN_Y_PIXEL_POS : 150.0 #;  these are used to decide if the beam is close to the edge
    MAX_Y_PIXEL_POS : 2000.0 #; these are used to decide if the beam is close to the edge
    HAS_LED : TRUE
    # empircally determined,  
    OPERATING_CENTER_X : 1000
    OPERATING_CENTER_Y : 1000
    MECHANICAL_CENTER_X : 1000
    MECHANICAL_CENTER_Y : 1000 
    
    
    MAX_BIT_DEPTH : 12
    # meh, is this a good way to def orientation? 
    # ALSWAYS assume image is chuncked in the X direction Y times
    ARRAY_DATA_NUM_PIX_X : 1392 #; array data passed through EPICS
    ARRAY_DATA_NUM_PIX_Y : 1040 #; array data passed through EPICS
    BINARY_NUM_PIX_X : 1392 #; the binary image is bigger than the array data passed through EPICS
    BINARY_NUM_PIX_Y : 1040 #; the binary image is bigger than the array data passed through EPICS
    # THEN we rotate the image and mirror it 
    IMAGE_ROTATION : 0 # could be 0, 90, 180, 270
    IMAGE_FLIP_UD : false
    IMAGE_FLIP_LR : false      